!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c335964c-f177-47c1-ad0b-b88d2e1ea848",e._sentryDebugIdIdentifier="sentry-dbid-c335964c-f177-47c1-ad0b-b88d2e1ea848")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8135],{88135:function(e,t,n){n.d(t,{l5:function(){return ep.Z},mM:function(){return eL}});var a=n(97458),l=n(40540),o=n(86474),r=n.n(o),i=n(48426),s=n(52983),d=n(65483),c=n(29442),u=n(63969),f=n(63730),m=n(59185),x=n(17829),v=n(54099),h=n(13411),g=n(61543),p=n(34671),y=n(43728),b=n(6347);function w(e){let{gridRef:t,rows:n}=e,a=(0,p.uM)(),l=(0,s.useMemo)(()=>{var e,t;return"windows"==((null===(e=navigator)||void 0===e?void 0:e.appVersion.indexOf("Win"))!==-1?"windows":(null===(t=navigator)||void 0===t?void 0:t.appVersion.indexOf("Mac"))!==-1?"macos":"unknown")?"Control":"Command"},[]);return(0,b.a)({["".concat(l,"+ArrowUp")]:e=>{if(e.stopPropagation(),a.selectedCellPosition){var n,l;let e={idx:null!==(l=null===(n=a.selectedCellPosition)||void 0===n?void 0:n.idx)&&void 0!==l?l:0,rowIdx:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(0)})},["".concat(l,"+ArrowDown")]:e=>{if(e.stopPropagation(),a.selectedCellPosition){var l,o;let e={idx:null!==(o=null===(l=a.selectedCellPosition)||void 0===l?void 0:l.idx)&&void 0!==o?o:0,rowIdx:n.length>1?n.length-1:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(n.length)})},["".concat(l,"+ArrowLeft")]:e=>{var n,l;e.stopPropagation();let o={idx:a.gridColumns.filter(e=>e.frozen).length,rowIdx:null!==(l=null===(n=a.selectedCellPosition)||void 0===n?void 0:n.rowIdx)&&void 0!==l?l:0};t.current.selectCell(o)},["".concat(l,"+ArrowRight")]:e=>{var n,l,o;e.stopPropagation(),null===(l=t.current)||void 0===l||l.selectCell({idx:a.gridColumns.length-2,rowIdx:null!==(o=null===(n=a.selectedCellPosition)||void 0===n?void 0:n.rowIdx)&&void 0!==o?o:0})}},["INPUT","TEXTAREA","SELECT"]),null}var j=n(6809),N=n(1112),C=n(95415),S=n(92345),k=n(62275),E=n(52253),R=n(55168),_=n(69899),T=n(97579),P=n(8145),I=n(97380),D=n(76028),L=n(15107),F=n(10503),z=n(5177);let M=e=>{if(0===e)return"0";let t=Math.floor(Math.log(e)/Math.log(1e3)),n=t>4?"T":["","K","M","B","T"][t];return"".concat((e/Math.pow(1e3,t>4?4:t)).toFixed(1)).concat(n)},A=[{value:100,label:"100 rows"},{value:500,label:"500 rows"},{value:1e3,label:"1000 rows"}];var G=()=>{var e,t;let{id:n}=(0,d.UO)(),l=n?Number(n):void 0,{project:o}=(0,m.d2)(),r=(0,g._2)(),i=(0,p.uM)(),{data:c}=(0,C.iB)({projectRef:null==o?void 0:o.ref,connectionString:null==o?void 0:o.connectionString,id:l}),u=(0,S.N3)(c)?c.live_rows_estimate:null,[{filter:f}]=(0,k.x)({arrayKeys:["filter"]}),x=(0,y.Yb)(f),v=i.page,b=(0,h.fN)(),[w,j]=(0,s.useState)(!1),[N,E]=(0,s.useState)(!1),[G,O]=(0,s.useState)(!1),[K,Z]=(0,s.useState)(v.toString());(0,s.useEffect)(()=>{Z(String(v))},[v]);let{data:U,isLoading:Q,isSuccess:V,isError:W,isFetching:q}=(0,P.HS)({projectRef:null==o?void 0:o.ref,connectionString:null==o?void 0:o.connectionString,tableId:l,filters:x,enforceExactCount:i.enforceExactCount,impersonatedRole:b.role},{keepPreviousData:!0}),B=(null==U?void 0:U.is_estimate)?M(U.count):null==U?void 0:U.count.toLocaleString(),X=Math.ceil((null!==(e=null==U?void 0:U.count)&&void 0!==e?e:0)/r.rowsPerPage),H=(null!==(t=null==U?void 0:U.count)&&void 0!==t?t:0)>0?X:1,Y=()=>{$()},J=()=>{ee()},$=()=>{let e=v-1;i.setPage(e)},ee=()=>{let e=v+1;i.setPage(e)},et=e=>{let t=e>X?X:e;i.setPage(t||1)};return(0,s.useEffect)(()=>{v&&v>H&&i.setPage(H)},[v,H]),(0,s.useEffect)(()=>{void 0!==l&&i.setEnforceExactCount(null!==u&&u<=P.Fi)},[l]),(0,a.jsxs)("div",{className:"flex items-center gap-x-4","data-sentry-component":"Pagination","data-sentry-source-file":"Pagination.tsx",children:[Q&&(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Loading records count..."}),V&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsx)(I.z,{icon:(0,a.jsx)(R.Z,{}),type:"outline",className:"px-1.5",disabled:v<=1||Q,onClick:()=>{v>1&&(i.selectedRows.size>=1?E(!0):$())}}),(0,a.jsx)("p",{className:"text-xs text-foreground-light",children:"Page"}),(0,a.jsx)(L.I,{className:"w-12",size:"tiny",min:1,max:X,value:K,onChange:e=>Z(e.target.value),onKeyDown:e=>{let t=Number(K);"Enter"===e.code&&!Number.isNaN(t)&&t>=1&&t<=X&&et(t)}}),(0,a.jsxs)("p",{className:"text-xs text-foreground-light",children:["of ",H.toLocaleString()]}),(0,a.jsx)(I.z,{icon:(0,a.jsx)(_.Z,{}),type:"outline",className:"px-1.5",disabled:v>=X||Q,onClick:()=>{v<X&&(i.selectedRows.size>=1?j(!0):ee())}}),(0,a.jsx)(z.F,{options:A,onSelect:e=>{let t=Number(e);r.setRowsPerPage(isNaN(t)?100:t)},side:"top",align:"start",children:(0,a.jsx)(I.z,{asChild:!0,type:"outline",style:{padding:"3px 10px"},children:(0,a.jsx)("span",{children:"".concat(r.rowsPerPage," rows")})})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsxs)("p",{className:"text-xs text-foreground-light",children:["".concat(B," ").concat(0===U.count||U.count>1?"records":"record")," ",U.is_estimate?"(estimated)":""]}),U.is_estimate&&(0,a.jsxs)(D.u,{children:[(0,a.jsx)(D.aJ,{asChild:!0,children:(0,a.jsx)(I.z,{size:"tiny",type:"text",className:"px-1.5",loading:q,icon:(0,a.jsx)(T.Z,{}),onClick:()=>{null===u||U.count>P.Fi?O(!0):i.setEnforceExactCount(!0)}})}),(0,a.jsxs)(D._v,{side:"top",className:"w-72",children:["This is an estimated value as your table has more than"," ",P.Fi.toLocaleString()," rows. ",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-brand",children:"Click to retrieve the exact count of the table."})]})]})]})]}),W&&(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Error fetching records count. Please refresh the page."}),(0,a.jsx)(F.Z,{visible:N,title:"Confirm moving to previous page",confirmLabel:"Confirm",onCancel:()=>E(!1),onConfirm:()=>{Y()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,a.jsx)(F.Z,{visible:w,title:"Confirm moving to next page",confirmLabel:"Confirm",onCancel:()=>j(!1),onConfirm:()=>{J()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,a.jsx)(F.Z,{variant:"warning",visible:G,title:"Confirm to fetch exact count for table",confirmLabel:"Retrieve exact count",onCancel:()=>O(!1),onConfirm:()=>{i.setEnforceExactCount(!0),O(!1)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:null===u?"If your table has a row count of greater than ".concat(P.Fi.toLocaleString()," rows,\n          retrieving the exact count of the table may cause performance issues on your database."):"Your table has a row count of greater than ".concat(P.Fi.toLocaleString()," rows, and\n          retrieving the exact count of the table may cause performance issues on your database.")})})]})},O=e=>{let{isRefetching:t}=e,{project:n}=(0,m.d2)(),{id:l}=(0,d.UO)(),o=l?Number(l):void 0,{data:r}=(0,C.iB)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString,id:o}),[{view:i="data"},s]=(0,k.x)(),c=(0,S.D1)(r),u=(0,S.N3)(r);return(0,a.jsxs)(j.x,{"data-sentry-element":"GridFooter","data-sentry-component":"Footer","data-sentry-source-file":"Footer.tsx",children:["data"===i&&(0,a.jsx)(G,{}),(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-x-2",children:[r&&"data"===i&&(0,a.jsx)(E.Z,{tableId:r.id,isRefetching:t}),(c||u)&&(0,a.jsx)(N.Z,{width:75,options:["definition","data"],activeOption:i,borderOverride:"border",onClickOption:e=>{"data"===e?s({view:void 0}):s({view:e})}})]})]})},K=n(44914),Z=n(79302);let U=()=>(0,a.jsx)("div",{className:"p-2 col-span-full","data-sentry-component":"TableGridInnerLoadingState","data-sentry-source-file":"LoadingState.tsx",children:(0,a.jsx)(Z.A,{"data-sentry-element":"GenericSkeletonLoader","data-sentry-source-file":"LoadingState.tsx"})}),Q=()=>(0,a.jsxs)("div",{className:"flex flex-col","data-sentry-component":"TableGridSkeletonLoader","data-sentry-source-file":"LoadingState.tsx",children:[(0,a.jsx)("div",{className:"h-10 bg-dash-sidebar dark:bg-surface-100"}),(0,a.jsx)("div",{className:"h-9 border-y"}),(0,a.jsx)(U,{"data-sentry-element":"TableGridInnerLoadingState","data-sentry-source-file":"LoadingState.tsx"})]});var V=n(5003),W=n(11426),q=n(46978),B=n(67803),X=n(97167),H=n(28453),Y=n(36457),J=n(34549),$=n(43527),ee=n(44658),et=n(14677),en=n(82362),ea=n(70717),el=n(59245);function eo(e,t){let{show:n}=(0,ea.av)();return(0,a.jsx)(K.X2,{...t,onContextMenu:function(e){n(e,{id:el.ep,props:{rowIdx:t.rowIdx}})},"data-sentry-element":"Row","data-sentry-component":"RowRenderer","data-sentry-source-file":"RowRenderer.tsx"},e)}let er=e=>{var t;return null!==(t=null==e?void 0:e.idx)&&void 0!==t?t:-1},ei=(0,s.memo)((0,s.forwardRef)((e,t)=>{var n;let{width:l,height:o,containerClass:r,gridClass:i,rowClass:d,rows:c,error:u,isLoading:f,isSuccess:x,isError:v,filters:b,onApplyFilters:w}=e,j=(0,g._2)(),N=(0,p.uM)(),C=function(e){let{project:t}=(0,m.d2)(),n=(0,p.uM)(),l=(0,Y.NL)(),o=(0,h.z6)(),{mutate:r}=(0,en.Gz)({async onMutate(e){let{projectRef:t,table:n,configuration:a,payload:o}=e,r=new Set(Object.keys(a.identifiers)),i=et.s.tableRows(t,{table:{id:n.id}});await l.cancelQueries(i);let s=l.getQueriesData(i);return l.setQueriesData(i,e=>{var t;return{rows:null!==(t=null==e?void 0:e.rows.map(e=>Object.entries(e).filter(e=>{let[t]=e;return r.has(t)}).every(e=>{let[t,n]=e;return n===a.identifiers[t]})?{...e,...o}:e))&&void 0!==t?t:[]}}),{previousRowsQueries:s}},onError(e,t,n){var a;let{previousRowsQueries:o}=n;o.forEach(e=>{let[t,n]=e;n&&l.setQueriesData(t,n),l.invalidateQueries(t)}),J.Am.error(null!==(a=null==e?void 0:e.message)&&void 0!==a?a:e)}});return(0,s.useCallback)((l,i)=>{var s;if(!t)return;let d=l[i.indexes[0]],c=e.find(e=>e.idx==d.idx),u=Object.keys(d).find(e=>d[e]!==c[e]);if(!c||!u)return;let f={[u]:d[u]},m=null===(s=n.originalTable.columns)||void 0===s?void 0:s.filter(e=>{var t;return(null!==(t=null==e?void 0:e.enums)&&void 0!==t?t:[]).length>0&&"array"===e.data_type.toLowerCase()}).map(e=>e.name),x={};if((0,S.N3)(n.originalTable)&&n.originalTable.primary_keys.forEach(e=>{let t=n.originalTable.columns.find(t=>t.name===e.name);x[e.name]=(null==t?void 0:t.format)==="bytea"?(0,$.D4)(c[e.name]):c[e.name]}),0===Object.keys(x).length)return(0,J.Am)("Unable to update row as table has no primary keys",{description:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Add a primary key column to your table first to serve as a unique identifier for each row before updating or deleting the row."}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(ee.G,{href:"https://supabase.com/docs/guides/database/tables#primary-keys"})})]})});r({projectRef:t.ref,connectionString:t.connectionString,table:n.originalTable,configuration:{identifiers:x},payload:f,enumArrayColumns:m,impersonatedRole:o()})},[o,r,t,e,n.originalTable])}(c),k=(0,s.useRef)(null),E=N.table,{mutate:R}=(0,B.a)(),_=(0,X.l)(),{project:T}=(0,m.d2)(),{data:P}=(0,q.XJ)({projectRef:null==T?void 0:T.ref,connectionString:null==T?void 0:T.connectionString,schema:null!==(n=null==E?void 0:E.schema)&&void 0!==n?n:void 0}),D=()=>{w([])};return(0,a.jsx)("div",{className:(0,H.cn)("flex flex-col",r),style:{width:l||"100%",height:o||"50vh"},children:(0,a.jsx)(K.ZP,{ref:t,className:"".concat(i," flex-grow"),rowClass:d,columns:N.gridColumns,rows:null!=c?c:[],renderers:{renderRow:eo,noRowsFallback:(0,a.jsxs)("div",{style:{width:"calc(100vw - 255px - 55px)"},children:[f&&(0,a.jsx)(U,{}),v&&(0,a.jsx)("div",{className:"p-2 col-span-full",children:(0,a.jsx)(W.Z,{error:u,subject:"Failed to retrieve rows from table",children:b.length>0&&(0,a.jsx)("p",{children:"Verify that the filter values are correct, as the error may stem from an incorrectly applied filter"})})}),x&&(0,a.jsx)(a.Fragment,{children:0===(null!=b?b:[]).length?(0,a.jsxs)("div",{style:{height:"calc(100% - 35px)"},className:"flex flex-col items-center justify-center col-span-full",children:[(0,a.jsx)("p",{className:"text-sm text-light",children:"This table is empty"}),(0,a.jsx)("p",{className:"text-sm text-light mt-1",children:"Add rows to your table to get started."}),(0,a.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,a.jsx)(I.z,{type:"default",onClick:()=>{var e,t;j.onImportData(),R({action:"import_data_button_clicked",properties:{tableType:"Existing Table"},groups:{project:null!==(e=null==T?void 0:T.ref)&&void 0!==e?e:"Unknown",organization:null!==(t=null==_?void 0:_.slug)&&void 0!==t?t:"Unknown"}})},children:"Import data from CSV"})})]}):(0,a.jsxs)("div",{style:{height:"calc(100% - 35px)"},className:"flex flex-col items-center justify-center col-span-full",children:[(0,a.jsx)("p",{className:"text-sm text-light",children:"The filters applied have returned no results from this table"}),(0,a.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,a.jsx)(I.z,{type:"default",onClick:()=>D(),children:"Remove all filters"})})]})})]})},rowKeyGetter:er,selectedRows:N.selectedRows,onColumnResize:N.updateColumnSize,onRowsChange:C,onSelectedCellChange:function(e){k.current=e,N.setSelectedCellPosition({idx:e.column.idx,rowIdx:e.rowIdx})},onSelectedRowsChange:function(e){N.setSelectedRows(e)},onCellDoubleClick:e=>(function(e,t){let n=function(e){var t,n;let{targetTableSchema:a,targetTableName:l,targetColumnName:o}=null!==(n=null==E?void 0:null===(t=E.columns.find(t=>t.name==e))||void 0===t?void 0:t.foreignKey)&&void 0!==n?n:{},r=null==P?void 0:P.find(t=>t.source_schema===(null==E?void 0:E.schema)&&t.source_table===(null==E?void 0:E.name)&&t.source_columns.includes(e)&&t.target_schema===a&&t.target_table===l&&t.target_columns.includes(o));return void 0!==r?(0,V.S)([r])[0]:void 0}(t.name);n&&j.onEditForeignKeyColumnValue({foreignKey:n,row:e,column:t})})(e.row,e.column),onCellKeyDown:y.FA})})}));var es=n(97742),ed=n(28827);let ec=e=>{var t;let{customHeader:n,gridProps:l,children:o}=e,{id:r}=(0,d.UO)(),i=r?Number(r):void 0,{project:b}=(0,m.d2)(),j=(0,g._2)(),N=(0,p.uM)(),C=(0,s.useRef)(null),[S,k]=(0,s.useState)(!1),{filters:E,sorts:R,setParams:_}=(0,ed.T)(),T=(0,y.rg)(N.table.name,R),P=(0,y.Yb)(E),I=(0,s.useCallback)(e=>{N.setEnforceExactCount(!1),N.setPage(1);let t=(0,y.Wy)(e);_(e=>({...e,filter:t})),(null==b?void 0:b.ref)&&(0,y.kl)({projectRef:b.ref,tableName:N.table.name,schema:N.table.schema,filters:t})},[null==b?void 0:b.ref,N.table.name,N.table.schema]),D=(0,h.fN)(),{data:L,error:F,isSuccess:z,isError:M,isLoading:A,isRefetching:G}=(0,x.KK)({projectRef:null==b?void 0:b.ref,connectionString:null==b?void 0:b.connectionString,tableId:i,sorts:T,filters:P,page:N.page,limit:j.rowsPerPage,impersonatedRole:D.role},{keepPreviousData:!0,retryDelay:(e,t)=>{var n;return(t&&(null===(n=t.message)||void 0===n?void 0:n.includes("does not exist"))&&_(e=>({...e,sort:void 0})),e>3)?1/0:5e3}});(0,s.useEffect)(()=>{S||k(!0)},[]);let K=null!==(t=null==L?void 0:L.rows)&&void 0!==t?t:v.Z6;return(0,a.jsx)(c.W,{backend:u.PD,context:window,"data-sentry-element":"DndProvider","data-sentry-component":"SupabaseGrid","data-sentry-source-file":"SupabaseGrid.tsx",children:(0,a.jsxs)("div",{className:"sb-grid h-full flex flex-col",children:[(0,a.jsx)(es.ZP,{sorts:T,filters:P,customHeader:n,"data-sentry-element":"Header","data-sentry-source-file":"SupabaseGrid.tsx"}),o||(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ei,{ref:C,...l,rows:K,error:F,isLoading:A,isSuccess:z,isError:M,filters:P,onApplyFilters:I}),(0,a.jsx)(O,{isRefetching:G}),(0,a.jsx)(w,{gridRef:C,rows:K})]}),S&&(0,f.createPortal)((0,a.jsx)(el.q4,{rows:K}),document.body)]})})};var eu=n(66092),ef=n(45524),em=n(79133),ex=n(62422),ev=n(97434),eh=n(18178),eg=e=>{let{id:t}=e;return(0,a.jsx)("div",{className:"flex items-center justify-center h-full","data-sentry-component":"NotFoundState","data-sentry-source-file":"NotFoundState.tsx",children:(0,a.jsx)("div",{className:"w-[400px]",children:(0,a.jsx)(ev.Z,{icon:(0,a.jsx)(eh.Z,{strokeWidth:2}),title:"Unable to find your table with ID ".concat(t),"data-sentry-element":"InformationBox","data-sentry-source-file":"NotFoundState.tsx"})})})},ep=n(75102),ey=n(85229),eb=n(98809),ew=n(94497),ej=n.n(ew),eN=n(28894),eC=n(66822),eS=n(80998),ek=n(44865);let eE=e=>{let{id:t}=e;return"\n    ".concat(eS.k,"\n\n    with table_info as (\n      select \n        n.nspname::text as schema,\n        c.relname::text as name\n      from pg_class c\n      join pg_namespace n on n.oid = c.relnamespace\n      where c.oid = ").concat(t,"\n    )\n    select pg_temp.pg_get_tabledef (\n      t.schema,\n      t.name,\n      false,\n      'FKEYS_INTERNAL',\n      'INCLUDE_TRIGGERS'\n    ) as definition\n    from table_info t;\n  ").trim()};async function eR(e,t){let{projectRef:n,connectionString:a,id:l}=e;if(!l)throw Error("id is required");let o=eE({id:l}),{result:r}=await (0,eC.R)({projectRef:n,connectionString:a,sql:o,queryKey:["table-definition",l]},t);return r[0].definition.trim()}let e_=function(e){let{projectRef:t,connectionString:n,id:a}=e,{enabled:l=!0,...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,eN.a)(ek.A.tableDefinition(t,a),e=>{let{signal:l}=e;return eR({projectRef:t,connectionString:n,id:a},l)},{enabled:l&&void 0!==t&&void 0!==a&&!isNaN(a),...o})};var eT=n(94945),eP=n(92869),eI=n(46382),eD=e=>{let{entity:t}=e,{ref:n}=(0,d.UO)(),l=(0,s.useRef)(null),o=(0,s.useRef)(null),{resolvedTheme:r}=(0,eb.F)(),{project:i}=(0,m.d2)(),c=(0,eT.s4)({id:null==t?void 0:t.id,projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString},{enabled:(0,S.D1)(t)}),u=e_({id:null==t?void 0:t.id,projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString},{enabled:(0,S.N3)(t)}),{data:f,isLoading:x}=(0,S.D1)(t)?c:u,v=(0,S.Du)(t)?"create view ".concat(t.schema,".").concat(t.name," as\n"):(0,S.z_)(t)?"create materialized view ".concat(t.schema,".").concat(t.name," as\n"):"",h=(0,s.useMemo)(()=>f?(0,eP._)(v+f):void 0,[f]),g=async(e,t)=>{l.current=e,o.current=t,e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})}),await (0,eI.Vs)(500),null==e||e.focus()};return x?(0,a.jsxs)("div",{className:"h-full grid",children:[(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(Z.A,{})}),(0,a.jsx)("div",{className:"mt-auto",children:(0,a.jsx)(O,{})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto border-t border-muted relative",children:[(0,a.jsx)(I.z,{asChild:!0,type:"default",className:"absolute top-2 right-5 z-10","data-sentry-element":"Button","data-sentry-source-file":"TableDefinition.tsx",children:(0,a.jsx)(ej(),{href:"/project/".concat(n,"/sql/new?content=").concat(encodeURIComponent(null!=h?h:"")),"data-sentry-element":"Link","data-sentry-source-file":"TableDefinition.tsx",children:"Open in SQL Editor"})}),(0,a.jsx)(ey.default,{className:"monaco-editor",theme:(null==r?void 0:r.includes("dark"))?"vs-dark":"vs",onMount:g,defaultLanguage:"pgsql",value:h,path:"",options:{domReadOnly:!0,readOnly:!0,tabSize:2,fontSize:13,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0},"data-sentry-element":"Editor","data-sentry-source-file":"TableDefinition.tsx"})]}),(0,a.jsx)(O,{"data-sentry-element":"Footer","data-sentry-source-file":"TableDefinition.tsx"})]})},eL=e=>{var t;let{isLoadingSelectedTable:n=!1,selectedTable:o}=e,c=(0,i.useRouter)(),u=(0,ef.Vm)(),{ref:f,id:m}=(0,d.UO)();(0,y.bQ)({projectRef:f,table:o});let[{view:x="data"}]=(0,k.x)(),v=(0,eu.Xo)(l.KA.TENANT_SQL_ADMIN_WRITE,"tables"),h=(0,eu.Xo)(l.KA.TENANT_SQL_ADMIN_WRITE,"columns"),g=(0,s.useCallback)(e=>{c.push("/project/".concat(f,"/editor/").concat(e.id))},[f,c]);if(n||!f)return(0,a.jsx)(Q,{});if(r()(o))return(0,a.jsx)(eg,{id:Number(m)});let b=(0,S.Du)(o)||(0,S.z_)(o),w=(0,S.N3)(o),j=em.s.includes(null!==(t=null==o?void 0:o.schema)&&void 0!==t?t:""),N=!(!v&&!h)&&w&&!j,C="".concat(o.schema,"_").concat(o.name);return(0,a.jsx)("div",{className:"h-full",onClick:()=>(0,ex.n0)(null==u?void 0:u.ref),"data-sentry-component":"TableGridEditor","data-sentry-source-file":"TableGridEditor.tsx",children:(0,a.jsxs)(p.t,{projectRef:f,table:o,editable:N,"data-sentry-element":"TableEditorTableStateContextProvider","data-sentry-source-file":"TableGridEditor.tsx",children:[(0,a.jsx)(ec,{gridProps:{height:"100%"},customHeader:(b||w)&&"definition"===x?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("p",{children:["SQL Definition of ",(0,a.jsx)("code",{className:"text-sm",children:o.name})," "]}),(0,a.jsx)("p",{className:"text-foreground-light text-sm",children:"(Read only)"})]}):null,"data-sentry-element":"SupabaseGrid","data-sentry-source-file":"TableGridEditor.tsx",children:(b||w)&&"definition"===x&&(0,a.jsx)(eD,{entity:o})},C),(0,a.jsx)(ep.Z,{editable:N,selectedTable:(0,S.N3)(o)?o:void 0,onTableCreated:g,"data-sentry-element":"SidePanelEditor","data-sentry-source-file":"TableGridEditor.tsx"})]},"table-editor-table-".concat(o.id))})};n(4501)},6347:function(e,t,n){n.d(t,{a:function(){return o}});var a=n(52983);function l(e,t){return e.indexOf(t)>=0}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],[o,r]=a.useState(),i=a=>{if(!e||l(t,a.target.nodeName)||l(n,a.target.className))return;let o=a.metaKey&&a.shiftKey?"Command+Shift+".concat(a.key):a.metaKey?"Command+".concat(a.key):a.shiftKey&&"Enter"===a.key?"Shift+".concat(a.key):a.ctrlKey&&a.key?"Control+".concat(a.key):a.key;e[o]&&(o.includes("+")?(a.preventDefault(),e[o](a),r(null)):(r(a.key),a.preventDefault()))},s=t=>{e&&e[t.key]&&o===t.key&&(t.preventDefault(),e[t.key](t),r(null))};a.useEffect(()=>(window.addEventListener("keydown",i),window.addEventListener("keyup",s),()=>{window.removeEventListener("keydown",i),window.removeEventListener("keyup",s)}))}},6809:function(e,t,n){n.d(t,{x:function(){return o}});var a=n(97458),l=n(28453);let o=e=>{let{children:t,className:n}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex min-h-9 h-9 overflow-hidden overflow-x-auto items-center px-2 w-full border-t",n),"data-sentry-component":"GridFooter","data-sentry-source-file":"GridFooter.tsx",children:t})}}}]);